services:
  receipty-ethernet:
    image: kaoshonen/receipty:latest
    profiles: ["ethernet"]
    ports:
      - "3000:3000"
    env_file: .env
    environment:
      PRINTER_MODE: "ethernet"
      APP_HOST: "0.0.0.0"
      PRINTER_HOST: "${PRINTER_HOST}"
      PRINTER_PORT: "${PRINTER_PORT:-9100}"
    volumes:
      - receipty-data:/app/data

  receipty-usb:
    image: kaoshonen/receipty:latest
    profiles: ["usb"]
    ports:
      - "3000:3000"
    env_file: .env
    environment:
      PRINTER_MODE: "usb"
      APP_HOST: "0.0.0.0"
      USB_VENDOR_ID: "${USB_VENDOR_ID}"
      USB_PRODUCT_ID: "${USB_PRODUCT_ID}"
      USB_DEVICE_PATH: "${USB_DEVICE_PATH:-/dev/usb/lp0}"
    devices:
      - "${USB_DEVICE_PATH:-/dev/usb/lp0}:${USB_DEVICE_PATH:-/dev/usb/lp0}"
    volumes:
      - receipty-data:/app/data
      - /dev/bus/usb:/dev/bus/usb

volumes:
  receipty-data:
